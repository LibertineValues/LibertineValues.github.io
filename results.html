<head>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:400,700" rel="stylesheet">
    <link href='style.css' rel='stylesheet' type='text/css'>
    <title>LibertineValues Results</title>
    <meta charset="utf-8">
    <script>
      version = "Test Edition #1" //Remember to update this before making changes to the test itself!
    </script>
    </head>
    <script type="application/javascript"
            src="ideologies.js">
    </script>
    
    <body>
    <h1>LibertineValues</h1>
    <hr>
    
    <h1>Results</h1>
    
    <h2>Morality Axis: <span class="weight-300" id="morality-label"></span></h2>
    <div class="axis">
        <div class="bar virtue" id="bar-virtue"><div class="text-wrapper" id="virtue"></div></div>
        <div class="bar vice" id="bar-vice"><div class="text-wrapper" id="vice"></div></div>
    </div>
    <h2>State Axis: <span class="weight-300" id="state-label"></span></h2>
    <div class="axis">
        <div class="bar authority" id="bar-authority"><div class="text-wrapper" id="authority"></div></div>
        <div class="bar liberty" id="bar-liberty"><div class="text-wrapper" id="liberty"></div></div>
    </div>
    <h2>Religious Axis: <span class="weight-300" id="religious-label"></span></h2>
   <div class="axis">
            <div class="bar theism" id="bar-theism"><div class="text-wrapper" id="theism"></div></div>
            <div class="bar atheism" id="bar-atheism"><div class="text-wrapper" id="atheism"></div></div>
    </div>
    <h2>Closest Match: <span class="weight-300" id="ideology-label"></span></h2>
    <p>Ideological matching is a work in progress, and is much less accurate than the values and axes.</p>
    <p>You can send these results by copying and pasting the URL at the top of the page or using the image below. Think your matched ideology was wrong? Want to help us calibrate the test? Send the results along with your political ideology to us at libertinevalues@gmail.com, or send us any comments, questions, or criticism. </p>
    <hr/>
    <img src="" id="banner">
    <button class="button" onclick="location.href='index.html';" style="background-color: #2196f3;">Back</button> <br>
    <!-- Website visit statistics - no personal information is collected! -->
    <script type="text/javascript">
    var sc_project=11325211;
    var sc_invisible=1;
    var sc_security="fd9f0659";
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/" target="_blank"><img
    class="statcounter"
    src="//c.statcounter.com/11325211/0/fd9f0659/1/" alt="web
    stats"></a></div></noscript>
    <script>
        function getQueryVariable(variable)
        {
               var query = window.location.search.substring(1)
               var vars = query.split("&")
               for (var i=0;i<vars.length;i++) {
                       var pair = vars[i].split("=")
                       if(pair[0] == variable) {return pair[1]}
               }
               return(NaN);
        }
    
        function setBarValue(name, value) {
            innerel = document.getElementById(name)
            outerel = document.getElementById("bar-" + name)
            outerel.style.width = (value + "%")
            innerel.innerHTML = (value + "%")
            if (innerel.offsetWidth + 20 > outerel.offsetWidth) {
                innerel.style.visibility = "hidden"
            }
        }
    
        moralityArray = ["Communist","Socialist","Social","Centrist","Market","Capitalist","Laissez-Faire"]
        stateArray = ["Cosmopolitan","Internationalist","Peaceful","Balanced","Patriotic","Nationalist","Chauvinist"]
        religiousArray = ["Revolutionary","Very Progressive","Progressive","Neutral","Traditional","Very Traditional","Reactionary"]
    
        function setLabel(val,ary) {
            if (val > 100) { return "" } else
            if (val > 90) { return ary[0] } else
            if (val > 75) { return ary[1] } else
            if (val > 60) { return ary[2] } else
            if (val >= 40) { return ary[3] } else
            if (val >= 25) { return ary[4] } else
            if (val >= 10) { return ary[5] } else
            if (val >= 0) { return ary[6] } else
                {return ""}
        }
    
        virtue  = getQueryVariable("e")
        authority     = getQueryVariable("d")
        theism  = getQueryVariable("s")
        vice    = (100 - virtue).toFixed(1)
        liberty     = (100 - authority  ).toFixed(1)
        atheism = (100 - theism).toFixed(1)
    
        setBarValue("virtue", virtue)
        setBarValue("vice", vice)
        setBarValue("authority", authority)
        setBarValue("liberty", liberty)
        setBarValue("theism", theism)
        setBarValue("atheism", atheism)
    
        document.getElementById("morality-label").innerHTML = setLabel(virtue, moralityArray)
        document.getElementById("state-label").innerHTML = setLabel(authority, stateArray)
        document.getElementById("religious-label").innerHTML = setLabel(theism, religiousArray)
    
        ideology = ""
        ideodist = Infinity
        for (var i = 0; i < ideologies.length; i++) {
            dist = 0
            dist += Math.pow(Math.abs(ideologies[i].stats.morality - virtue), 2)
            dist += Math.pow(Math.abs(ideologies[i].stats.state- authority), 2)
            dist += Math.pow(Math.abs(ideologies[i].stats.religious - theism), 1.73856063)
            if (dist < ideodist) {
                ideology = ideologies[i].name
                ideodist = dist
            }
        }
        document.getElementById("ideology-label").innerHTML = ideology
    
        function createImage(src, x, y, w, h) {
            img = new Image ()
            img.src = src
            img.onLoad = function() {
                ctx.drawImage(img, x, y, w, h)
            }
        }
    
        window.onload = function() {
            var c = document.createElement("canvas")
            var ctx = c.getContext("2d")
            c.width = 800;
            c.height = 650;
            ctx.fillStyle = "#EEEEEE"
            ctx.fillRect(0,0,800,650);
    
            img = document.getElementById("img-virtue")
            ctx.drawImage(img, 20, 170, 100, 100);
            img = document.getElementById("img-vice")
            ctx.drawImage(img, 680, 170, 100, 100)
            img = document.getElementById("img-authority")
            ctx.drawImage(img, 20, 290, 100, 100)
            img = document.getElementById("img-liberty")
            ctx.drawImage(img, 680, 290, 100, 100)
            img = document.getElementById("img-theism")
            ctx.drawImage(img, 20, 530, 100, 100)
            img = document.getElementById("img-atheism")
            ctx.drawImage(img, 680, 530, 100, 100)
    
            ctx.fillStyle="#222222"
            ctx.fillRect(120, 180, 560, 80)
            ctx.fillRect(120, 300, 560, 80)
            ctx.fillRect(120, 420, 560, 80)
            ctx.fillRect(120, 540, 560, 80)
            ctx.fillStyle="#f44336"
            ctx.fillRect(120, 184, 5.6*virtue-2, 72)
            ctx.fillStyle="#00897b"
            ctx.fillRect(682-5.6*vice, 184, 5.6*vice-2, 72)
            ctx.fillStyle="#ff9800"
            ctx.fillRect(120, 304, 5.6*authority-2, 72)
            ctx.fillStyle="#03a9f4"
            ctx.fillRect(682-5.6*liberty, 304, 5.6*liberty-2, 72)
            ctx.fillStyle="#ffeb3b"
            ctx.fillRect(120, 544, 5.6*theism-2, 72)
            ctx.fillStyle="#9c27b0"
            ctx.fillRect(682-5.6*atheism, 544, 5.6*atheism-2, 72)
            ctx.fillStyle="#222222"
            ctx.font="700 80px Montserrat"
            ctx.textAlign="left"
            ctx.fillText("8values", 20, 90)
            ctx.font="50px Montserrat"
            ctx.fillText(ideology, 20, 140)
    
            ctx.textAlign="left"
            if (virtue  > 30) {ctx.fillText(virtue + "%", 130, 237.5)}
            if (authority     > 30) {ctx.fillText(authority + "%", 130, 357.5)}
            if (theism > 30) {ctx.fillText(theism + "%", 130, 597.5)}
            ctx.textAlign="right"
            if (vice    > 30) {ctx.fillText(vice + "%", 670, 237.5)}
            if (liberty    > 30) {ctx.fillText(liberty + "%", 670, 357.5)}
            if (atheism > 30) {ctx.fillText(atheism + "%", 670, 597.5)}
    
            ctx.font="300 30px Montserrat"
            ctx.fillText("libertinevalues.github.io", 780, 60)
            ctx.fillText(version, 780, 90)
            ctx.textAlign="center"
            ctx.fillText("Morality Axis: " + document.getElementById("morality-label").innerHTML, 400, 175)
            ctx.fillText("State Axis: " + document.getElementById("state-label").innerHTML, 400, 295)
            ctx.fillText("Religious Axis: " + document.getElementById("religious-label").innerHTML, 400, 535)
    
            document.getElementById("banner").src = c.toDataURL();
        }
        </script>
    </body>
    